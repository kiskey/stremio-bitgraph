<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stremio Fusion - Configuration</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: #282c34; color: #fff; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: #3c4049; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.4); max-width: 500px; width: 100%; }
        h1 { text-align: center; color: #61afef; }
        label { display: block; margin-bottom: 0.5rem; color: #abb2bf; }
        input, select { width: 100%; padding: 0.75rem; margin-bottom: 1rem; border-radius: 4px; border: 1px solid #282c34; background: #21252b; color: #abb2bf; box-sizing: border-box; }
        .sort-group { display: flex; align-items: center; margin-bottom: 1rem; }
        .sort-group label { flex-grow: 1; }
        button { width: 100%; padding: 0.75rem; border: none; border-radius: 4px; background: #61afef; color: #282c34; font-size: 1rem; font-weight: bold; cursor: pointer; transition: background 0.2s; }
        button:hover { background: #5298d8; }
        #install-link-container { margin-top: 1.5rem; text-align: center; display: none; }
        #install-link { display: inline-block; padding: 0.75rem 1.5rem; background: #98c379; color: #282c34; text-decoration: none; border-radius: 4px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Stremio Fusion Setup</h1>
        <form id="config-form">
            <label for="rdKey">Real-Debrid API Key (Optional)</label>
            <input type="password" id="rdKey" name="rdKey" placeholder="Your Real-Debrid API key">

            <label for="quality">Preferred Quality Keywords (OR logic)</label>
            <input type="text" id="quality" name="quality" value="1080p | 2160p | 4k | remux" placeholder="e.g., 1080p | 2160p">

            <label for="language">Preferred Language Keywords (OR logic)</label>
            <input type="text" id="language" name="language" value="eng | en" placeholder="e.g., eng | en">
            
            <label for="minSeeders">Minimum Seeders</label>
            <input type="number" id="minSeeders" name="minSeeders" value="5" min="0">

            <label>Stream Sort Priority</label>
            <div class="sort-group">
                <label for="sort1">1st Priority</label>
                <select id="sort1" name="sort1">
                    <option value="language" selected>Language</option>
                    <option value="quality">Quality</option>
                    <option value="seeders">Seeders</option>
                    <option value="fuzzyScore">Title Match</option>
                </select>
            </div>
             <div class="sort-group">
                <label for="sort2">2nd Priority</label>
                <select id="sort2" name="sort2">
                    <option value="quality" selected>Quality</option>
                    <option value="language">Language</option>
                    <option value="seeders">Seeders</option>
                    <option value="fuzzyScore">Title Match</option>
                </select>
            </div>
             <div class="sort-group">
                <label for="sort3">3rd Priority</label>
                <select id="sort3" name="sort3">
                    <option value="seeders" selected>Seeders</option>
                    <option value="language">Language</option>
                    <option value="quality">Quality</option>
                    <option value="fuzzyScore">Title Match</option>
                </select>
            </div>

            <button type="submit">Generate Install Link</button>
        </form>

        <div id="install-link-container">
            <a href="#" id="install-link">Install Addon in Stremio</a>
        </div>
    </div>

    <script>
        document.getElementById('config-form').addEventListener('submit', function(event) {
            event.preventDefault();

            const config = {
                rdKey: document.getElementById('rdKey').value,
                quality: document.getElementById('quality').value,
                language: document.getElementById('language').value,
                minSeeders: parseInt(document.getElementById('minSeeders').value, 10),
                sortOrder: [
                    document.getElementById('sort1').value,
                    document.getElementById('sort2').value,
                    document.getElementById('sort3').value,
                ]
            };
            
            const configString = encodeURIComponent(JSON.stringify(config));
            const baseUrl = window.location.origin;
            const installUrl = `${baseUrl}/${configString}/manifest.json`;

            const installLink = document.getElementById('install-link');
            installLink.href = `stremio://${installUrl}`; // Use stremio:// protocol
            
            document.getElementById('install-link-container').style.display = 'block';
        });
    </script>
</body>
</html>
